datasource db {
  provider = "mysql" 
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  password  String
  roleId    Int?     
  role      Role?    @relation(fields: [roleId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  @@map("users")
  Role Role[] @relation("UserRoles")
}

model Role {
  id          Int             @id @default(autoincrement())  
  name        String          @unique                    
  desc        String?         
  users       User[]          @relation("UserRoles")        
  permissions RolePermission[] 

  createdAt   DateTime        @default(now())              
  updatedAt   DateTime        @updatedAt                    

  @@map("roles")               
  User User[]
}

model Permission {
  id          Int               @id @default(autoincrement())  
  name        String            @unique               
  description String?         
  roles       RolePermission[] 

  createdAt   DateTime          @default(now())              
  updatedAt   DateTime          @updatedAt                  

  @@map("permissions")          
}


model RolePermission {
  id          Int         @id @default(autoincrement())
  roleId      Int         
  permissionId Int        

  role        Role        @relation(fields: [roleId], references: [id])  
  permission  Permission  @relation(fields: [permissionId], references: [id])  

  createdAt   DateTime    @default(now())  
  updatedAt   DateTime    @updatedAt       

  @@map("role_permissions")  
  @@unique([roleId, permissionId])  
}
